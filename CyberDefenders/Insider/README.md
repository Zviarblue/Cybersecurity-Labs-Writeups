# Insider

## Challenge Information

- **Platform**: CyberDefenders
- **Difficulty**: Easy
- **Category**: Endpoint Forensics
- **Link**: https://cyberdefenders.org/blueteam-ctf-challenges/insider/
- **Scenario**: After Karen started working for "TAAUSAI," she began to do some illegal activities inside the company. The company's SOC team captured a disk image from her machine to investigate these actions. Your task is to analyze the image and answer the provided questions.

## Tools Used

- FTK Imager - For disk image analysis and artifact extraction
- Windows File Explorer - For navigating extracted files
- Text Editor - For log and file content analysis

## Investigation Methodology

### Question 1: What is the MD5 hash value of the machine?

**Analysis Steps:**
1. Opened the disk image in FTK Imager
2. Located the Evidence Tree panel
3. Right-clicked on the evidence item to view properties
4. Found the MD5 hash in the image properties/verification section

**Evidence Found:**
The MD5 hash is displayed in FTK Imager's evidence properties, which is automatically calculated when the image is loaded.

**Answer:** `[MD5 hash from your analysis]`

---

### Question 2: What is the computer account name?

**Analysis Steps:**
1. Navigated to the Windows system files in FTK Imager
2. Located `C:\Windows\System32\config\` directory
3. Examined the SAM (Security Account Manager) registry hive
4. Alternatively, checked `C:\Users\` folder to identify user profiles

**Evidence Found:**
The computer account name is visible in the user profile directories and system configuration files.

**Answer:** `[Computer account name]`

---

### Question 3: What is the user's account name?

**Analysis Steps:**
1. Navigated to `C:\Users\` directory in FTK Imager
2. Identified user profile folders (excluding Default, Public, Administrator)
3. Cross-referenced with recent activity in user directories

**Evidence Found:**
User profile directory showing Karen's account.

**Answer:** `[User account name]`

---

### Question 4: What is the user's password hint?

**Analysis Steps:**
1. Located the SAM registry hive in `C:\Windows\System32\config\SAM`
2. Extracted and examined registry entries
3. Password hints are stored in the SAM database for local accounts
4. Alternative: Checked user account settings if accessible

**Evidence Found:**
Password hint associated with Karen's user account.

**Answer:** `[Password hint text]`

---

### Question 5: What is the NTLM hash of the user's password?

**Analysis Steps:**
1. Extracted the SAM registry hive from `C:\Windows\System32\config\SAM`
2. Also extracted SYSTEM hive (needed to decrypt SAM)
3. Used registry analysis to locate NTLM hash for the user account
4. NTLM hashes are stored in the SAM database in encrypted form

**Evidence Found:**
NTLM hash extracted from SAM registry for Karen's account.

**Answer:** `[NTLM hash]`

---

### Question 6: What is the computer IP address?

**Analysis Steps:**
1. Checked network configuration files and logs
2. Examined `C:\Windows\System32\drivers\etc\hosts` file
3. Looked for DHCP lease information in `C:\Windows\System32\dhcp\`
4. Reviewed Windows Event Logs for network activity
5. Checked Registry: `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces`

**Evidence Found:**
IP address configuration from network settings or logs.

**Answer:** `[IP address]`

---

### Question 7: What was the filename of the malicious file?

**Analysis Steps:**
1. Analyzed recent file activity in Karen's user directories
2. Checked Downloads folder: `C:\Users\[username]\Downloads\`
3. Examined browser history and download records
4. Looked for suspicious file extensions (.exe, .scr, .bat, .ps1)
5. Checked Recent files and Desktop for anomalies

**Evidence Found:**
Suspicious file located in user's Downloads or Desktop folder.

**Answer:** `[Filename with extension]`

---

### Question 8: What is the download location of the malicious file?

**Analysis Steps:**
1. Examined browser history databases
2. For Chrome: `C:\Users\[username]\AppData\Local\Google\Chrome\User Data\Default\History`
3. For Firefox: `C:\Users\[username]\AppData\Roaming\Mozilla\Firefox\Profiles\`
4. Searched for the malicious filename in download history
5. Extracted URL from browser artifacts

**Evidence Found:**
Download URL from browser history database showing source of malicious file.

**Answer:** `[Full URL]`

---

### Question 9: What is the MD5 hash of the malicious file?

**Analysis Steps:**
1. Located the malicious file in FTK Imager
2. Right-clicked on the file and selected "Verify File"
3. FTK Imager calculated and displayed the MD5 hash
4. Alternatively, exported the file and used hash calculation tools

**Evidence Found:**
MD5 hash generated by FTK Imager for the malicious file.

**Answer:** `[MD5 hash]`

---

### Question 10: What is the URL of the remote site the malware connected to?

**Analysis Steps:**
1. Examined network connection logs
2. Checked `C:\Windows\System32\winevt\Logs\` for network events
3. Analyzed Windows Firewall logs
4. Examined browser history for suspicious connections
5. Looked for strings in the malicious file itself that might contain URLs
6. Checked DNS cache and prefetch files

**Evidence Found:**
Remote C2 (Command and Control) server URL identified through network artifacts.

**Answer:** `[URL or domain]`

---

## Key Findings Summary

- **Attack Vector**: Insider threat - Karen downloaded and executed malicious software
- **Indicators of Compromise (IOCs)**:
  - Malicious File: `[filename]`
  - File Hash (MD5): `[hash]`
  - C2 Server: `[URL]`
  - User Account Compromised: `[username]`
- **Timeline**: 
  1. Malicious file downloaded from external source
  2. File executed on local system
  3. Connection established to remote C2 server
  4. Suspicious activity detected by SOC

## MITRE ATT&CK Mapping

| Tactic | Technique | Description |
|--------|-----------|-------------|
| Initial Access | T1566 - Phishing | User downloaded malicious file from external source |
| Execution | T1204.002 - User Execution: Malicious File | User manually executed the downloaded malware |
| Command and Control | T1071.001 - Web Protocols | Malware communicated with C2 server via HTTP/HTTPS |
| Persistence | T1547 - Boot or Logon Autostart | Potential persistence mechanism (if applicable) |

## Lessons Learned

- **Registry Analysis**: Understanding Windows registry structure is crucial for forensic investigations
- **Browser Artifacts**: Browser history and download records provide valuable timeline information
- **Hash Analysis**: File hashing is essential for identifying and tracking malicious files
- **Network Indicators**: Identifying C2 infrastructure helps in threat intelligence gathering
- **FTK Imager Proficiency**: Improved skills in navigating disk images and extracting artifacts systematically

## Skills Developed

- Disk image analysis using FTK Imager
- Windows Registry forensics
- Browser artifact analysis
- Hash calculation and IOC identification
- Timeline reconstruction
- MITRE ATT&CK framework application

## References

- [CyberDefenders - Insider Challenge](https://cyberdefenders.org/blueteam-ctf-challenges/insider/)
- [MITRE ATT&CK Framework](https://attack.mitre.org/)
- [FTK Imager Documentation](https://www.exterro.com/ftk-imager)

---

**Completion Date**: [Your completion date]  
**Time Spent**: ~2-3 hours
